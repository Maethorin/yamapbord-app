<div class="{{column.name | lowercase}} column-container" ng-class="{'expanded': column.expanded, 'col-md-3': !column.expanded && column.colSpan === 3, 'col-md-2': !column.expanded && column.colSpan === 2}">
  <div class="panel panel-default">
    <div class="panel-heading" ng-click="toggleExpandColumn(column)">
      <div class="col-md-12">
        <h3>
          <span ng-bind="column.label"></span>
          <span class="badge {{column.name | lowercase }}" title="Total column points" ng-bind="pointsPerStoryTypeStatus[column.name]"></span>
          <span class="label label-warning stories-length" title="Total column stories" ng-bind="stories[column.name].length"></span>
        </h3>
      </div>
    </div>
    <div class="panel-body column {{column.name | lowercase}}" ng-scrollable="columnScrollOptions[column.name]">
      <div ng-repeat="story in stories[column.name] | filter:{archived: false}" class="panel panel-default story">
        <div class="panel-heading" title="{{story.statement}}">
          <div class="col-md-12" ui-sref="storyBoardState({boardType: selectedSprint.type, boardId: selectedSprint.id, storyId: story.id})" ng-click="toggleCompleteStoryPopup(story)">
            <span class="story-type" ng-class="story.type | lowercase " title="{{story.typeName}}"></span>
            <span class="story-name" ng-bind="story.name|limitWithEllipsis:22"></span>
            <span class="badge points-{{story.points}}">{{story.points}}</span>
            <span class="badge value-points-{{story.valuePoints}}">{{story.valuePoints}}</span>
          </div>
        </div>
        <div class="panel-body" ng-if="story.hasTasks">
          <ul class="list-group">
            <li class="list-group-item" ng-class="{'list-group-item-success': task.complete, 'list-group-item-warning': !task.complete }" ng-repeat="task in story.tasks">
              <i class="fa fa-fw" ng-if="column.name == 'STAR'" ng-click="changeTaskStatus($event, task, $index, story)" ng-class="{'fa-square-o': !task.changing && !task.complete, 'fa-spinner fa-spin': task.changing, 'fa-check-square-o': !task.changing && task.complete}"></i>
              {{ task.task }}
            </li>
          </ul>
        </div>
        <div class="panel-footer">
          <button type="button" class="btn btn-danger btn-xs btn-go-back-story" ng-click="moveStoryBack(story)" ng-if="story.status !== 'PLAN'">
            <i class="fa fa-chevron-left"></i>
            <i class="fa fa-chevron-left minus-margin"></i>
          </button>
          <owner-name story="story"></owner-name>
          <button type="button" title="Archive Story" class="btn btn-warning btn-xs" ng-click="archiveStory(story)" ng-if="story.status === 'ACCP'">
            <i class="fa fa-archive"></i>
          </button>
          <button type="button" class="btn btn-success btn-xs btn-go-forward-story" ng-click="moveStoryForward(story)" ng-if="story.status !== 'REJE'">
            <i class="fa fa-chevron-right minus-margin"></i>
            <i class="fa fa-chevron-right"></i>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>